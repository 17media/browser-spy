{"version":3,"file":"index.js","sources":["../src/utils/loadScript.ts","../src/utils/object.ts","../src/Agent.ts","../src/utils/dom.ts","../src/utils/param.ts","../src/Source.ts","../src/types.ts","../src/Observer.ts","../src/hooks.ts","../src/utils/constants.ts","../src/actions.ts"],"sourcesContent":["export function loadScript(src: string) {\n  const script = document.createElement('script');\n  script.type = 'text/javascript';\n  script.defer = true;\n  script.src = src;\n\n  const firstScript = document.getElementsByTagName('script')[0];\n  firstScript.parentNode!.insertBefore(script, firstScript);\n\n  return new Promise((resolve, reject) => {\n    script.onload = resolve;\n    script.onerror = reject;\n  });\n}\n\nexport function loadScripts(...src: string[]) {\n  return Promise.all(src.map(loadScript));\n}\n","export function trim(object: Record<string, any>) {\n  for (const key in object) {\n    if (typeof object[key] === 'undefined') {\n      delete object[key];\n    }\n    if (object[key] === null) {\n      delete object[key];\n    }\n  }\n}\n\nexport function convertStringToSankecase(str: string) {\n  const upperCaseMap = new Map();\n  const strArray = Array.from(str);\n  strArray.forEach((char, index) => {\n    const currentCharCode = char.charCodeAt(0);\n    const asciiCodeA = 'A'.charCodeAt(0);\n    const asciiCodeZ = 'Z'.charCodeAt(0);\n    if (currentCharCode >= asciiCodeA && currentCharCode <= asciiCodeZ) {\n      upperCaseMap.set(index, char);\n    }\n  });\n  upperCaseMap.forEach((value, key) => {\n    strArray[key] = `_${value.toLowerCase()}`;\n  });\n  return strArray.join('');\n}\n\nexport function convertParamsToSankecase<T>(params: T) {\n  return Object.keys(params).reduce((prev: Record<string, any>, key: string) => {\n    const currentParams = prev;\n    const snakecaseKey = convertStringToSankecase(key);\n    currentParams[snakecaseKey] = (params as any)[key];\n    return currentParams;\n  }, {});\n}\n","/* eslint-disable @typescript-eslint/camelcase */\nimport { loadScript, loadScripts } from 'utils/loadScript';\nimport * as object from 'utils/object';\nimport { TrackingEvent, TransitionEvent, LoginEvent, SpyEvent } from 'types';\n\nenum AgentState {\n  Uninitialized,\n  Initializing,\n  Initialized,\n  InitializeFail,\n}\n\nexport abstract class Agent {\n  protected state = AgentState.Uninitialized;\n\n  async initialize() {\n    if (this.state !== AgentState.Uninitialized) return;\n\n    this.state = AgentState.Initializing;\n\n    try {\n      await this.doInitialize();\n      this.state = AgentState.Initialized;\n    } catch (error) {\n      console.error(error);\n      this.state = AgentState.InitializeFail;\n    }\n  }\n\n  abstract report(event: SpyEvent): void;\n\n  protected abstract doInitialize(): Promise<void> | void;\n}\n\nlet isInit = false;\n\nexport class FirebaseAgent extends Agent {\n  private client!: firebase.analytics.Analytics;\n\n  private queue: Array<() => void> = [];\n\n  /**\n   * @param config @see https://support.google.com/firebase/answer/7015592\n   */\n  constructor(readonly config: any) {\n    super();\n  }\n\n  async doInitialize() {\n    await loadScripts(\n      'https://www.gstatic.com/firebasejs/7.14.1/firebase-app.js',\n      'https://www.gstatic.com/firebasejs/7.14.1/firebase-analytics.js',\n    );\n\n    const firebase = await import('firebase');\n\n    if (!isInit) {\n      this.client = firebase.initializeApp(this.config).analytics();\n      isInit = true;\n    } else {\n      this.client = firebase.analytics();\n    }\n\n    this.queue.forEach(callback => callback());\n\n    this.queue = [];\n  }\n\n  report(event: SpyEvent) {\n    this.queueIfNotInitialized(() => this.doReport(event));\n  }\n\n  private doReport(event: SpyEvent) {\n    switch (event.type) {\n      case 'login':\n        return this.login(event);\n      case 'tracking':\n        return this.track(event);\n      case 'transition':\n        return this.transit(event);\n      default:\n        break;\n    }\n  }\n\n  private login(event: LoginEvent) {\n    const { userId } = event;\n    this.client.setUserId(userId, { global: true });\n    if (userId) this.client.logEvent('login', { userId });\n  }\n\n  private transit(event: TransitionEvent) {\n    const { toScene, defaultTrackingParams } = event;\n    const { title, hostname, pathname } = toScene;\n    this.client.logEvent('page_view', {\n      page_title: title,\n      page_location: hostname,\n      page_path: pathname,\n      ...object.convertParamsToSankecase(defaultTrackingParams),\n    });\n    this.client.setCurrentScreen(event.toScene.title, { global: true });\n  }\n\n  private track(event: TrackingEvent) {\n    const { eventName, trackingParams = {} } = event;\n    object.trim(trackingParams);\n    this.client.logEvent(eventName, object.convertParamsToSankecase(trackingParams));\n  }\n\n  private queueIfNotInitialized(callback: () => void) {\n    if (this.state === AgentState.Initialized) callback();\n    else this.queue.push(callback);\n  }\n}\n\nexport interface MatomoAgentConfig {\n  endpoint: string;\n  siteId: string;\n}\n\nexport class MatomoAgent extends Agent {\n  private client = window._paq; // eslint-disable-line no-underscore-dangle\n\n  private trackPageViewTimer = 0;\n\n  private intialized = false;\n\n  constructor(readonly config: MatomoAgentConfig) {\n    super();\n  }\n\n  async doInitialize() {\n    const url = `//${this.config.endpoint}/`;\n    this.client.push(['setTrackerUrl', `${url}matomo.php`]);\n    this.client.push(['setSiteId', this.config.siteId]);\n    this.client.push(['trackPageView']);\n    this.client.push(['enableLinkTracking']);\n    this.client.push(['trackAllContentImpressions']);\n\n    await loadScript(`${url}piwik.js`);\n  }\n\n  report(event: SpyEvent) {\n    switch (event.type) {\n      case 'login':\n        return this.login(event);\n      case 'tracking':\n        return this.track(event);\n      case 'transition':\n        return this.transit(event);\n      default:\n        break;\n    }\n  }\n\n  private login(event: LoginEvent) {\n    const { userId } = event;\n    if (userId) this.client.push(['setUserId', userId]);\n    else this.client.push(['resetUserId']);\n    this.requestTrackPageView();\n  }\n\n  private transit(event: TransitionEvent) {\n    const { fromScene, toScene } = event;\n    this.client.push(['setReferrerUrl', `${fromScene.hostname}${fromScene.pathname}`]);\n    this.client.push(['setCustomUrl', `${toScene.hostname}${fromScene.pathname}`]);\n    this.client.push(['setDocumentTitle', toScene.title]);\n    this.client.push(['setGenerationTimeMs', 0]);\n    this.requestTrackPageView();\n    this.client.push(['enableLinkTracking']);\n    this.client.push(['trackAllContentImpressions']);\n  }\n\n  private track(event: TrackingEvent) {\n    /**\n     * ref : https://developer.matomo.org/guides/tracking-javascript\n     * trackEvent(category, action, [name], [value]) -\n     * Log an event with an event category (Videos, Music, Games...), an event action (Play, Pause, Duration, Add Playlist, Downloaded, Clicked...), and an optional event name and optional numeric value.\n     */\n    const { eventName, category, trackingParams = {} } = event;\n    const { name = '', value = '' } = trackingParams;\n    this.client.push(['trackEvent', category, eventName, name, value]);\n  }\n\n  private requestTrackPageView() {\n    if (this.trackPageViewTimer) clearTimeout(this.trackPageViewTimer);\n    this.trackPageViewTimer = setTimeout(() => {\n      this.client.push(['trackPageView']);\n      this.trackPageViewTimer = 0;\n    });\n  }\n}\n","const tagNameRole: Record<string, string | undefined> = {\n  alert: 'alert',\n  alertdialog: 'alertdialog',\n  application: 'application',\n  article: 'article',\n  banner: 'banner',\n  button: 'button',\n  cell: 'cell',\n  checkbox: 'checkbox',\n  columnheader: 'columnheader',\n  combobox: 'combobox',\n  command: 'command',\n  complementary: 'complementary',\n  composite: 'composite',\n  contentinfo: 'contentinfo',\n  definition: 'definition',\n  dialog: 'dialog',\n  directory: 'directory',\n  document: 'document',\n  feed: 'feed',\n  figure: 'figure',\n  form: 'form',\n  grid: 'grid',\n  gridcell: 'gridcell',\n  group: 'group',\n  heading: 'heading',\n  img: 'img',\n  input: 'input',\n  landmark: 'landmark',\n  link: 'link',\n  list: 'list',\n  listbox: 'listbox',\n  listitem: 'listitem',\n  log: 'log',\n  main: 'main',\n  'The main content of a document.': 'The main content of a document.',\n  marquee: 'marquee',\n  math: 'math',\n  'Content that represents a mathematical expression.': 'Content that represents a mathematical expression.',\n  menu: 'menu',\n  menubar: 'menubar',\n  menuitem: 'menuitem',\n  menuitemcheckbox: 'menuitemcheckbox',\n  menuitemradio: 'menuitemradio',\n  navigation: 'navigation',\n  none: 'none',\n  note: 'note',\n  option: 'option',\n  presentation: 'presentation',\n  progressbar: 'progressbar',\n  radio: 'radio',\n  radiogroup: 'radiogroup',\n  range: 'range',\n  region: 'region',\n  roletype: 'roletype',\n  row: 'row',\n  rowgroup: 'rowgroup',\n  rowheader: 'rowheader',\n  scrollbar: 'scrollbar',\n  search: 'search',\n  searchbox: 'searchbox',\n  section: 'section',\n  sectionhead: 'sectionhead',\n  select: 'select',\n  separator: 'separator',\n  slider: 'slider',\n  spinbutton: 'spinbutton',\n  status: 'status',\n  structure: 'structure',\n  switch: 'switch',\n  tab: 'tab',\n  table: 'table',\n  tablist: 'tablist',\n  tabpanel: 'tabpanel',\n  term: 'term',\n  textbox: 'textbox',\n  timer: 'timer',\n  toolbar: 'toolbar',\n  tooltip: 'tooltip',\n  tree: 'tree',\n  treegrid: 'treegrid',\n  treeitem: 'treeitem',\n  widget: 'widget',\n  window: 'window',\n};\n\nexport function guessRole(element: HTMLElement) {\n  return element.getAttribute('role') || tagNameRole[element.tagName] || 'unknown';\n}\n\nexport function getContent(element: HTMLElement) {\n  return element.innerText;\n}\n","import { Scene, DefaultEventParams, RefinedEventPathname } from 'types';\n\nexport function createScene(): Scene {\n  const { title } = window.document;\n  const { hostname, pathname } = window.location;\n  return { title, hostname, pathname };\n}\n\nexport function refineEventPathname(pathname: string): RefinedEventPathname {\n  const slashCount = pathname.match(/-/g)?.length;\n  if (!slashCount) return { eventId: '', codename: '' };\n  if (slashCount === 1 || slashCount === 2) return { eventId: '', codename: pathname };\n  // slashCount === 3+\n  const pathnameArray = pathname.split('-');\n  const eventId = pathnameArray[0];\n  const codename = pathnameArray.splice(1, pathnameArray.length).join('-');\n  return { eventId, codename };\n}\n\nexport function createDefaultEventParams(): DefaultEventParams {\n  const codenameArray = window.location.pathname.split('/');\n  const eventPathname = codenameArray.length > 1 ? codenameArray[1] : '';\n  const { eventId, codename } = refineEventPathname(eventPathname);\n\n  return {\n    userId: sessionStorage.getItem('userID') || 'guest',\n    lang: navigator.language || '',\n    os: navigator.userAgent || '',\n    timestamp: Date.now(),\n    codename,\n    eventId,\n  };\n}\n","import { TransitionEvent, TrackingEvent, TrackingEventParams, Scene } from 'types';\nimport { Agent } from 'Agent';\nimport { History } from 'history';\nimport * as dom from 'utils/dom';\nimport { createScene, createDefaultEventParams } from 'utils/param';\n\nexport interface Source {\n  addAgent(agent: Agent): void;\n}\n\nexport class DefaultSource implements Source {\n  private agents: Agent[] = [];\n\n  private currentScene: Scene = createScene();\n\n  addAgent(agent: Agent) {\n    agent.initialize();\n    this.agents.push(agent);\n  }\n\n  spyTransition(history: History) {\n    // wait for whole page updated\n    // init page_view\n    setTimeout(() => this.transit(createScene()), 100);\n    history.listen(() => {\n      const { action } = history;\n      // Filtering replace action (The pushed url is not matching, ex: Redirect)\n      if (action === 'PUSH') {\n        setTimeout(() => this.transit(createScene()), 100);\n      }\n    });\n  }\n\n  spyClick() {\n    window.addEventListener('click', event => {\n      const { target } = event;\n      if (target instanceof HTMLElement) {\n        this.track({\n          eventName: 'click',\n          category: 'default',\n          trackingParams: {\n            name: dom.getContent(target),\n            value: '',\n            role: dom.guessRole(target),\n          },\n        });\n      }\n    });\n  }\n\n  // tracking page visibility. e.g. page minimized, change browser tab or page unload\n  spyPageDurationByVisible(params?: TrackingEventParams) {\n    let startDurationTime: number = 0;\n\n    const handleVisibleChange = (e: Event) => {\n      if (document.visibilityState === 'hidden') {\n        const endDurationTime = e.timeStamp;\n        const duration = Math.floor(endDurationTime - startDurationTime);\n        this.track({\n          eventName: 'pageView',\n          category: 'default',\n          trackingParams: {\n            url: window.location.href,\n            duration,\n            ...params,\n          },\n        });\n      }\n      if (document.visibilityState === 'visible') {\n        startDurationTime = e.timeStamp;\n      }\n    };\n    document.addEventListener('visibilitychange', handleVisibleChange);\n  }\n\n  spyPageDurationByTransition(history: History, params?: TrackingEventParams) {\n    let startDurationTime: number = Date.now();\n    let url = window.location.href;\n    history.listen(() => {\n      const endDurationTime: number = Date.now();\n      const duration = Math.floor(endDurationTime - startDurationTime);\n      this.track({\n        eventName: 'pageView',\n        category: 'default',\n        trackingParams: {\n          url,\n          duration,\n          ...params,\n        },\n      });\n      startDurationTime = endDurationTime;\n      url = window.location.href;\n    });\n  }\n\n  login(userId: string) {\n    this.agents.forEach(agent => agent.report({ type: 'login', userId }));\n  }\n\n  transit(toScene: Scene) {\n    const fromScene = this.currentScene;\n    const event: TransitionEvent = {\n      type: 'transition',\n      fromScene,\n      toScene,\n      defaultTrackingParams: createDefaultEventParams(),\n    };\n    this.agents.forEach(agent => agent.report(event));\n  }\n\n  track(event: Omit<TrackingEvent, 'type'>) {\n    const { trackingParams } = event;\n    const defaultParams = trackingParams?.hasOwnProperty('productName') ? {} : createDefaultEventParams();\n    const mergedTrackingParams = {\n      ...defaultParams,\n      ...trackingParams,\n    };\n    event.trackingParams = mergedTrackingParams;\n    this.agents.forEach(agent => agent.report({ type: 'tracking', ...event }));\n  }\n}\n","export enum Threshold {\n  'MIN' = 0,\n  'HALF' = 0.5,\n  'FULL' = 1,\n}\n\nexport interface Scene {\n  title: string;\n  hostname: string;\n  pathname: string;\n}\n\nexport interface TransitionEvent {\n  type: 'transition';\n  fromScene: Scene;\n  toScene: Scene;\n  defaultTrackingParams: DefaultEventParams;\n}\n\nexport interface TrackingEventParams {\n  userId?: string;\n  lang?: string;\n  os?: string;\n  eventId?: string;\n  timestamp?: number;\n  action?: string;\n  name?: string;\n  role?: string;\n  value?: string;\n  page?: string;\n  type?: string;\n  leaderboardId?: string;\n  streamerId?: string;\n  liveStatus?: boolean;\n  section?: string;\n  rank?: number;\n  to?: string;\n  url?: string;\n  utmCampaign?: string;\n  utmContent?: string;\n  utmMedium?: string;\n  utmSource?: string;\n  searchString?: string;\n  resultCount?: number;\n  hasDeeplink?: boolean;\n  codename?: string;\n  productName?: string;\n  userName?: string;\n  from?: string;\n  result?: string;\n  duration?: number;\n}\nexport interface TrackingEvent {\n  type: 'tracking';\n  eventName: string;\n  category: string;\n  trackingParams?: TrackingEventParams;\n}\n\nexport interface DefaultEventParams {\n  userId: string;\n  lang: string;\n  os: string;\n  eventId: string;\n  timestamp: number;\n  codename: string;\n}\n\nexport interface LoginEvent {\n  type: 'login';\n  userId: string;\n}\n\nexport interface RefinedEventPathname {\n  eventId: string;\n  codename: string;\n}\n\nexport type ElementMap = Map<Element, Function>;\n\nexport type SpyEvent = TrackingEvent | TransitionEvent | LoginEvent;\n\nexport type EventCallback<T> = (event: T) => void;\n\nexport type EventListener<T> = (callback: EventCallback<T>) => void;\n","import { RefObject } from 'react';\nimport { ElementMap, Threshold } from './types';\nimport 'intersection-observer';\n\nclass SectionObserver {\n  private observer: IntersectionObserver | undefined;\n\n  private elementMap: ElementMap;\n\n  private debounceExecute = 0;\n\n  constructor(debounce: boolean, threshold: Threshold) {\n    this.elementMap = new Map();\n    try {\n      this.observer = new window.IntersectionObserver(\n        entries => {\n          if (debounce) {\n            this.debounceSectionIntersect(entries);\n          } else {\n            this.sectionIntersect(entries);\n          }\n        },\n        {\n          threshold: [threshold],\n        },\n      );\n    } catch (error) {\n      console.log(`Error occur when creating IntersectionObserver: ${error}`);\n    }\n  }\n\n  sectionObserve = (ref: RefObject<any>, callback: Function) => {\n    this.observer?.observe(ref.current);\n    this.elementMap.set(ref.current, callback);\n  };\n\n  sectionUnobserve = (ref: RefObject<any>) => {\n    this.observer?.unobserve(ref.current);\n    if (this.elementMap.has(ref.current)) this.elementMap.delete(ref.current);\n  };\n\n  resetSectionObserver = () => {\n    this.elementMap.forEach((value, key) => {\n      this.observer?.observe(key);\n    });\n  };\n\n  private sectionIntersect = (entries: IntersectionObserverEntry[]) => {\n    entries.forEach(entry => {\n      const { target } = entry;\n      if (entry.isIntersecting && this.elementMap.has(target)) {\n        const callback = this.elementMap.get(target);\n        if (!callback) return;\n\n        callback();\n\n        this.observer?.unobserve(target);\n      }\n    });\n  };\n\n  private debounceSectionIntersect = (entries: IntersectionObserverEntry[]) => {\n    entries.forEach(entry => {\n      const { target } = entry;\n      if (entry.isIntersecting && this.elementMap.has(target)) {\n        const callback = this.elementMap.get(target);\n        if (!callback) return;\n\n        clearTimeout(this.debounceExecute);\n        this.debounceExecute = window.setTimeout(() => {\n          callback();\n        }, 1000);\n\n        this.observer?.unobserve(target);\n      }\n    });\n  };\n}\n\nexport const completeSectionObserver = new SectionObserver(false, Threshold.FULL);\nexport const halfSectionObserver = new SectionObserver(false, Threshold.HALF);\nexport const minSectionObserver = new SectionObserver(false, Threshold.MIN);\nexport const rankSectionObserver = new SectionObserver(true, Threshold.FULL);\n","import { RefObject, useEffect } from 'react';\n\nimport { completeSectionObserver, halfSectionObserver, minSectionObserver, rankSectionObserver } from './Observer';\n\nexport const useCompleteSectionTracking = (ref: RefObject<any>, callback: Function) => {\n  useEffect(() => {\n    if (ref.current === null) return;\n    completeSectionObserver.sectionObserve(ref, callback);\n    return () => {\n      completeSectionObserver.sectionUnobserve(ref);\n    };\n  });\n};\n\nexport const useHalfSectionTracking = (ref: RefObject<any>, callback: Function) => {\n  useEffect(() => {\n    if (ref.current === null) return;\n    halfSectionObserver.sectionObserve(ref, callback);\n    return () => {\n      halfSectionObserver.sectionUnobserve(ref);\n    };\n  });\n};\n\nexport const useMinSectionTracking = (ref: RefObject<any>, callback: Function) => {\n  useEffect(() => {\n    if (ref.current === null) return;\n    minSectionObserver.sectionObserve(ref, callback);\n    return () => {\n      minSectionObserver.sectionUnobserve(ref);\n    };\n  });\n};\n\nexport const useRankSectionTracking = (ref: RefObject<any>, callback: Function) => {\n  useEffect(() => {\n    if (ref.current === null) return;\n    rankSectionObserver.sectionObserve(ref, callback);\n    return () => {\n      rankSectionObserver.sectionUnobserve(ref);\n    };\n  });\n};\n\nexport function testing() {\n  rankSectionObserver.sectionObserve({} as RefObject<any>, () => {});\n}\n","export const EVENT_NAME_CLICK = 'click';\nexport const EVENT_NAME_ENTER = 'enter';\nexport const EVENT_NAME_LEAVE = 'leave';\nexport const EVENT_NAME_SEARCH = 'search';\nexport const EVENT_NAME_SECTION_VIEW = 'section_view';\n\nexport const CATEGORY_DEFAULT = 'default';\n\nexport const ACTION_BUTTON_CLICK = 'ButtonClick';\nexport const ACTION_TAB_CLICK = 'TabClick';\nexport const ACTION_PROFILE_CLICK = 'ProfileClick';\nexport const ACTION_LINK_CLICK = 'LinkClick';\nexport const ACTION_ENTER = 'enter';\n","import {\n  EVENT_NAME_CLICK,\n  EVENT_NAME_ENTER,\n  EVENT_NAME_LEAVE,\n  EVENT_NAME_SEARCH,\n  EVENT_NAME_SECTION_VIEW,\n  CATEGORY_DEFAULT,\n  ACTION_BUTTON_CLICK,\n  ACTION_TAB_CLICK,\n  ACTION_PROFILE_CLICK,\n  ACTION_LINK_CLICK,\n  ACTION_ENTER,\n} from './utils/constants';\n\nimport { TrackingEvent } from './types';\n\ntype EventAction = Omit<TrackingEvent, 'type'>;\n\nexport function createButtonClickAction(buttonName: string, link: string): EventAction {\n  return {\n    eventName: EVENT_NAME_CLICK,\n    category: CATEGORY_DEFAULT,\n    trackingParams: {\n      action: ACTION_BUTTON_CLICK,\n      name: buttonName,\n      page: link,\n    },\n  };\n}\n\nexport function createPageEnterAction(\n  utmCampaign: string,\n  utmContent: string,\n  utmMedium: string,\n  utmSource: string,\n): EventAction {\n  return {\n    eventName: EVENT_NAME_ENTER,\n    category: CATEGORY_DEFAULT,\n    trackingParams: {\n      utmCampaign,\n      utmContent,\n      utmMedium,\n      utmSource,\n    },\n  };\n}\n\nexport function createPageLeaveAction(): EventAction {\n  return {\n    eventName: EVENT_NAME_LEAVE,\n    category: CATEGORY_DEFAULT,\n  };\n}\n\nexport function createTabClickAction(link: string, tabName: string): EventAction {\n  return {\n    eventName: EVENT_NAME_CLICK,\n    category: CATEGORY_DEFAULT,\n    trackingParams: {\n      action: ACTION_TAB_CLICK,\n      page: link,\n      name: tabName,\n    },\n  };\n}\n\nexport function createProfileClickAction(userID: string, liveStatus: boolean, profileType: string): EventAction {\n  return {\n    eventName: EVENT_NAME_CLICK,\n    category: CATEGORY_DEFAULT,\n    trackingParams: {\n      action: ACTION_PROFILE_CLICK,\n      type: profileType,\n      streamerId: userID,\n      liveStatus: liveStatus,\n      leaderboardId: '',\n      hasDeeplink: false,\n    },\n  };\n}\n\nexport function createSearchAction(keyword: string, count: number): EventAction {\n  return {\n    eventName: EVENT_NAME_SEARCH,\n    category: CATEGORY_DEFAULT,\n    trackingParams: {\n      searchString: keyword,\n      resultCount: count,\n    },\n  };\n}\n\nexport function createVoteAction(voteTopic: string): EventAction {\n  return {\n    eventName: EVENT_NAME_CLICK,\n    category: CATEGORY_DEFAULT,\n    trackingParams: {\n      action: ACTION_BUTTON_CLICK,\n      name: voteTopic,\n      type: 'vote',\n    },\n  };\n}\n\nexport function createLeaderboardSectionViewAction(rank: number): EventAction {\n  return {\n    eventName: EVENT_NAME_SECTION_VIEW,\n    category: CATEGORY_DEFAULT,\n    trackingParams: {\n      action: ACTION_ENTER,\n      section: 'leaderboardItem',\n      rank,\n    },\n  };\n}\n\nexport function createLinkClickAction(link: string, linkName: string): EventAction {\n  return {\n    eventName: EVENT_NAME_CLICK,\n    category: CATEGORY_DEFAULT,\n    trackingParams: {\n      action: ACTION_LINK_CLICK,\n      url: link,\n      name: linkName,\n    },\n  };\n}\n\nexport function createSectionViewAction(section: string): EventAction {\n  return {\n    eventName: EVENT_NAME_SECTION_VIEW,\n    category: CATEGORY_DEFAULT,\n    trackingParams: {\n      action: ACTION_ENTER,\n      section,\n    },\n  };\n}\n"],"names":["object.convertParamsToSankecase","object.trim","dom.getContent","dom.guessRole","Threshold","useEffect"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAM,SAAU,UAAV,CAAqB,GAArB,EAAgC;AACpC,QAAM,MAAM,GAAG,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAf;AACA,EAAA,MAAM,CAAC,IAAP,GAAc,iBAAd;AACA,EAAA,MAAM,CAAC,KAAP,GAAe,IAAf;AACA,EAAA,MAAM,CAAC,GAAP,GAAa,GAAb;AAEA,QAAM,WAAW,GAAG,QAAQ,CAAC,oBAAT,CAA8B,QAA9B,EAAwC,CAAxC,CAApB;AACA,EAAA,WAAW,CAAC,UAAZ,CAAwB,YAAxB,CAAqC,MAArC,EAA6C,WAA7C;AAEA,SAAO,IAAI,OAAJ,CAAY,CAAC,OAAD,EAAU,MAAV,KAAoB;AACrC,IAAA,MAAM,CAAC,MAAP,GAAgB,OAAhB;AACA,IAAA,MAAM,CAAC,OAAP,GAAiB,MAAjB;AACD,GAHM,CAAP;AAID;AAEK,SAAU,WAAV,CAAsB,GAAG,GAAzB,EAAsC;AAC1C,SAAO,OAAO,CAAC,GAAR,CAAY,GAAG,CAAC,GAAJ,CAAQ,UAAR,CAAZ,CAAP;AACD;;ACjBK,SAAU,IAAV,CAAe,MAAf,EAA0C;AAC9C,OAAK,MAAM,GAAX,IAAkB,MAAlB,EAA0B;AACxB,QAAI,OAAO,MAAM,CAAC,GAAD,CAAb,KAAuB,WAA3B,EAAwC;AACtC,aAAO,MAAM,CAAC,GAAD,CAAb;AACD;;AACD,QAAI,MAAM,CAAC,GAAD,CAAN,KAAgB,IAApB,EAA0B;AACxB,aAAO,MAAM,CAAC,GAAD,CAAb;AACD;AACF;AACF;AAEK,SAAU,wBAAV,CAAmC,GAAnC,EAA8C;AAClD,QAAM,YAAY,GAAG,IAAI,GAAJ,EAArB;AACA,QAAM,QAAQ,GAAG,KAAK,CAAC,IAAN,CAAW,GAAX,CAAjB;AACA,EAAA,QAAQ,CAAC,OAAT,CAAiB,CAAC,IAAD,EAAO,KAAP,KAAgB;AAC/B,UAAM,eAAe,GAAG,IAAI,CAAC,UAAL,CAAgB,CAAhB,CAAxB;AACA,UAAM,UAAU,GAAG,IAAI,UAAJ,CAAe,CAAf,CAAnB;AACA,UAAM,UAAU,GAAG,IAAI,UAAJ,CAAe,CAAf,CAAnB;;AACA,QAAI,eAAe,IAAI,UAAnB,IAAiC,eAAe,IAAI,UAAxD,EAAoE;AAClE,MAAA,YAAY,CAAC,GAAb,CAAiB,KAAjB,EAAwB,IAAxB;AACD;AACF,GAPD;AAQA,EAAA,YAAY,CAAC,OAAb,CAAqB,CAAC,KAAD,EAAQ,GAAR,KAAe;AAClC,IAAA,QAAQ,CAAC,GAAD,CAAR,GAAgB,IAAI,KAAK,CAAC,WAAN,EAAmB,EAAvC;AACD,GAFD;AAGA,SAAO,QAAQ,CAAC,IAAT,CAAc,EAAd,CAAP;AACD;AAEK,SAAU,wBAAV,CAAsC,MAAtC,EAA+C;AACnD,SAAO,MAAM,CAAC,IAAP,CAAY,MAAZ,EAAoB,MAApB,CAA2B,CAAC,IAAD,EAA4B,GAA5B,KAA2C;AAC3E,UAAM,aAAa,GAAG,IAAtB;AACA,UAAM,YAAY,GAAG,wBAAwB,CAAC,GAAD,CAA7C;AACA,IAAA,aAAa,CAAC,YAAD,CAAb,GAA+B,MAAc,CAAC,GAAD,CAA7C;AACA,WAAO,aAAP;AACD,GALM,EAKJ,EALI,CAAP;AAMD;;ACnCD;AAKA,IAAK,UAAL;;AAAA,CAAA,UAAK,UAAL,EAAe;AACb,EAAA,UAAA,CAAA,UAAA,CAAA,eAAA,CAAA,GAAA,CAAA,CAAA,GAAA,eAAA;AACA,EAAA,UAAA,CAAA,UAAA,CAAA,cAAA,CAAA,GAAA,CAAA,CAAA,GAAA,cAAA;AACA,EAAA,UAAA,CAAA,UAAA,CAAA,aAAA,CAAA,GAAA,CAAA,CAAA,GAAA,aAAA;AACA,EAAA,UAAA,CAAA,UAAA,CAAA,gBAAA,CAAA,GAAA,CAAA,CAAA,GAAA,gBAAA;AACD,CALD,EAAK,UAAU,KAAV,UAAU,GAAA,EAAA,CAAf;;AAOM,MAAgB,KAAhB,CAAqB;AAA3B,EAAA,WAAA,GAAA;AACY,SAAA,KAAA,GAAQ,UAAU,CAAC,aAAnB;AAmBX;;AAjBC,QAAM,UAAN,GAAgB;AACd,QAAI,KAAK,KAAL,KAAe,UAAU,CAAC,aAA9B,EAA6C;AAE7C,SAAK,KAAL,GAAa,UAAU,CAAC,YAAxB;;AAEA,QAAI;AACF,YAAM,KAAK,YAAL,EAAN;AACA,WAAK,KAAL,GAAa,UAAU,CAAC,WAAxB;AACD,KAHD,CAGE,OAAO,KAAP,EAAc;AACd,MAAA,OAAO,CAAC,KAAR,CAAc,KAAd;AACA,WAAK,KAAL,GAAa,UAAU,CAAC,cAAxB;AACD;AACF;;AAfwB;AAsB3B,IAAI,MAAM,GAAG,KAAb;AAEM,MAAO,aAAP,SAA6B,KAA7B,CAAkC;AAKtC;;;AAGA,EAAA,WAAA,CAAqB,MAArB,EAAgC;AAC9B;AADmB,SAAA,MAAA,GAAA,MAAA;AALb,SAAA,KAAA,GAA2B,EAA3B;AAOP;;AAED,QAAM,YAAN,GAAkB;AAChB,UAAM,WAAW,CACf,2DADe,EAEf,iEAFe,CAAjB;AAKA,UAAM,QAAQ,GAAG,MAAM,sEAAO,UAAP,MAAvB;;AAEA,QAAI,CAAC,MAAL,EAAa;AACX,WAAK,MAAL,GAAc,QAAQ,CAAC,aAAT,CAAuB,KAAK,MAA5B,EAAoC,SAApC,EAAd;AACA,MAAA,MAAM,GAAG,IAAT;AACD,KAHD,MAGO;AACL,WAAK,MAAL,GAAc,QAAQ,CAAC,SAAT,EAAd;AACD;;AAED,SAAK,KAAL,CAAW,OAAX,CAAmB,QAAQ,IAAI,QAAQ,EAAvC;AAEA,SAAK,KAAL,GAAa,EAAb;AACD;;AAED,EAAA,MAAM,CAAC,KAAD,EAAgB;AACpB,SAAK,qBAAL,CAA2B,MAAM,KAAK,QAAL,CAAc,KAAd,CAAjC;AACD;;AAEO,EAAA,QAAQ,CAAC,KAAD,EAAgB;AAC9B,YAAQ,KAAK,CAAC,IAAd;AACE,WAAK,OAAL;AACE,eAAO,KAAK,KAAL,CAAW,KAAX,CAAP;;AACF,WAAK,UAAL;AACE,eAAO,KAAK,KAAL,CAAW,KAAX,CAAP;;AACF,WAAK,YAAL;AACE,eAAO,KAAK,OAAL,CAAa,KAAb,CAAP;AANJ;AAUD;;AAEO,EAAA,KAAK,CAAC,KAAD,EAAkB;AAC7B,UAAM;AAAE,MAAA;AAAF,QAAa,KAAnB;AACA,SAAK,MAAL,CAAY,SAAZ,CAAsB,MAAtB,EAA8B;AAAE,MAAA,MAAM,EAAE;AAAV,KAA9B;AACA,QAAI,MAAJ,EAAY,KAAK,MAAL,CAAY,QAAZ,CAAqB,OAArB,EAA8B;AAAE,MAAA;AAAF,KAA9B;AACb;;AAEO,EAAA,OAAO,CAAC,KAAD,EAAuB;AACpC,UAAM;AAAE,MAAA,OAAF;AAAW,MAAA;AAAX,QAAqC,KAA3C;AACA,UAAM;AAAE,MAAA,KAAF;AAAS,MAAA,QAAT;AAAmB,MAAA;AAAnB,QAAgC,OAAtC;AACA,SAAK,MAAL,CAAY,QAAZ,CAAqB,WAArB,EAAkC;AAChC,MAAA,UAAU,EAAE,KADoB;AAEhC,MAAA,aAAa,EAAE,QAFiB;AAGhC,MAAA,SAAS,EAAE,QAHqB;AAIhC,SAAGA,wBAAA,CAAgC,qBAAhC;AAJ6B,KAAlC;AAMA,SAAK,MAAL,CAAY,gBAAZ,CAA6B,KAAK,CAAC,OAAN,CAAc,KAA3C,EAAkD;AAAE,MAAA,MAAM,EAAE;AAAV,KAAlD;AACD;;AAEO,EAAA,KAAK,CAAC,KAAD,EAAqB;AAChC,UAAM;AAAE,MAAA,SAAF;AAAa,MAAA,cAAc,GAAG;AAA9B,QAAqC,KAA3C;AACA,IAAAC,IAAA,CAAY,cAAZ;AACA,SAAK,MAAL,CAAY,QAAZ,CAAqB,SAArB,EAAgCD,wBAAA,CAAgC,cAAhC,CAAhC;AACD;;AAEO,EAAA,qBAAqB,CAAC,QAAD,EAAqB;AAChD,QAAI,KAAK,KAAL,KAAe,UAAU,CAAC,WAA9B,EAA2C,QAAQ,GAAnD,KACK,KAAK,KAAL,CAAW,IAAX,CAAgB,QAAhB;AACN;;AA5EqC;AAoFlC,MAAO,WAAP,SAA2B,KAA3B,CAAgC;AAOpC,EAAA,WAAA,CAAqB,MAArB,EAA8C;AAC5C;AADmB,SAAA,MAAA,GAAA,MAAA;AANb,SAAA,MAAA,GAAS,MAAM,CAAC,IAAhB,CAMsC;;AAJtC,SAAA,kBAAA,GAAqB,CAArB;AAEA,SAAA,UAAA,GAAa,KAAb;AAIP;;AAED,QAAM,YAAN,GAAkB;AAChB,UAAM,GAAG,GAAG,KAAK,KAAK,MAAL,CAAY,QAAQ,GAArC;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,eAAD,EAAkB,GAAG,GAAG,YAAxB,CAAjB;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,WAAD,EAAc,KAAK,MAAL,CAAY,MAA1B,CAAjB;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,eAAD,CAAjB;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,oBAAD,CAAjB;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,4BAAD,CAAjB;AAEA,UAAM,UAAU,CAAC,GAAG,GAAG,UAAP,CAAhB;AACD;;AAED,EAAA,MAAM,CAAC,KAAD,EAAgB;AACpB,YAAQ,KAAK,CAAC,IAAd;AACE,WAAK,OAAL;AACE,eAAO,KAAK,KAAL,CAAW,KAAX,CAAP;;AACF,WAAK,UAAL;AACE,eAAO,KAAK,KAAL,CAAW,KAAX,CAAP;;AACF,WAAK,YAAL;AACE,eAAO,KAAK,OAAL,CAAa,KAAb,CAAP;AANJ;AAUD;;AAEO,EAAA,KAAK,CAAC,KAAD,EAAkB;AAC7B,UAAM;AAAE,MAAA;AAAF,QAAa,KAAnB;AACA,QAAI,MAAJ,EAAY,KAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,WAAD,EAAc,MAAd,CAAjB,EAAZ,KACK,KAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,aAAD,CAAjB;AACL,SAAK,oBAAL;AACD;;AAEO,EAAA,OAAO,CAAC,KAAD,EAAuB;AACpC,UAAM;AAAE,MAAA,SAAF;AAAa,MAAA;AAAb,QAAyB,KAA/B;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,gBAAD,EAAmB,GAAG,SAAS,CAAC,QAAQ,GAAG,SAAS,CAAC,QAAQ,EAA7D,CAAjB;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,cAAD,EAAiB,GAAG,OAAO,CAAC,QAAQ,GAAG,SAAS,CAAC,QAAQ,EAAzD,CAAjB;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,kBAAD,EAAqB,OAAO,CAAC,KAA7B,CAAjB;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,qBAAD,EAAwB,CAAxB,CAAjB;AACA,SAAK,oBAAL;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,oBAAD,CAAjB;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,4BAAD,CAAjB;AACD;;AAEO,EAAA,KAAK,CAAC,KAAD,EAAqB;AAChC;;;;;AAKA,UAAM;AAAE,MAAA,SAAF;AAAa,MAAA,QAAb;AAAuB,MAAA,cAAc,GAAG;AAAxC,QAA+C,KAArD;AACA,UAAM;AAAE,MAAA,IAAI,GAAG,EAAT;AAAa,MAAA,KAAK,GAAG;AAArB,QAA4B,cAAlC;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,YAAD,EAAe,QAAf,EAAyB,SAAzB,EAAoC,IAApC,EAA0C,KAA1C,CAAjB;AACD;;AAEO,EAAA,oBAAoB,GAAA;AAC1B,QAAI,KAAK,kBAAT,EAA6B,YAAY,CAAC,KAAK,kBAAN,CAAZ;AAC7B,SAAK,kBAAL,GAA0B,UAAU,CAAC,MAAK;AACxC,WAAK,MAAL,CAAY,IAAZ,CAAiB,CAAC,eAAD,CAAjB;AACA,WAAK,kBAAL,GAA0B,CAA1B;AACD,KAHmC,CAApC;AAID;;AAtEmC;;ACxHtC,MAAM,WAAW,GAAuC;AACtD,EAAA,KAAK,EAAE,OAD+C;AAEtD,EAAA,WAAW,EAAE,aAFyC;AAGtD,EAAA,WAAW,EAAE,aAHyC;AAItD,EAAA,OAAO,EAAE,SAJ6C;AAKtD,EAAA,MAAM,EAAE,QAL8C;AAMtD,EAAA,MAAM,EAAE,QAN8C;AAOtD,EAAA,IAAI,EAAE,MAPgD;AAQtD,EAAA,QAAQ,EAAE,UAR4C;AAStD,EAAA,YAAY,EAAE,cATwC;AAUtD,EAAA,QAAQ,EAAE,UAV4C;AAWtD,EAAA,OAAO,EAAE,SAX6C;AAYtD,EAAA,aAAa,EAAE,eAZuC;AAatD,EAAA,SAAS,EAAE,WAb2C;AActD,EAAA,WAAW,EAAE,aAdyC;AAetD,EAAA,UAAU,EAAE,YAf0C;AAgBtD,EAAA,MAAM,EAAE,QAhB8C;AAiBtD,EAAA,SAAS,EAAE,WAjB2C;AAkBtD,EAAA,QAAQ,EAAE,UAlB4C;AAmBtD,EAAA,IAAI,EAAE,MAnBgD;AAoBtD,EAAA,MAAM,EAAE,QApB8C;AAqBtD,EAAA,IAAI,EAAE,MArBgD;AAsBtD,EAAA,IAAI,EAAE,MAtBgD;AAuBtD,EAAA,QAAQ,EAAE,UAvB4C;AAwBtD,EAAA,KAAK,EAAE,OAxB+C;AAyBtD,EAAA,OAAO,EAAE,SAzB6C;AA0BtD,EAAA,GAAG,EAAE,KA1BiD;AA2BtD,EAAA,KAAK,EAAE,OA3B+C;AA4BtD,EAAA,QAAQ,EAAE,UA5B4C;AA6BtD,EAAA,IAAI,EAAE,MA7BgD;AA8BtD,EAAA,IAAI,EAAE,MA9BgD;AA+BtD,EAAA,OAAO,EAAE,SA/B6C;AAgCtD,EAAA,QAAQ,EAAE,UAhC4C;AAiCtD,EAAA,GAAG,EAAE,KAjCiD;AAkCtD,EAAA,IAAI,EAAE,MAlCgD;AAmCtD,qCAAmC,iCAnCmB;AAoCtD,EAAA,OAAO,EAAE,SApC6C;AAqCtD,EAAA,IAAI,EAAE,MArCgD;AAsCtD,wDAAsD,oDAtCA;AAuCtD,EAAA,IAAI,EAAE,MAvCgD;AAwCtD,EAAA,OAAO,EAAE,SAxC6C;AAyCtD,EAAA,QAAQ,EAAE,UAzC4C;AA0CtD,EAAA,gBAAgB,EAAE,kBA1CoC;AA2CtD,EAAA,aAAa,EAAE,eA3CuC;AA4CtD,EAAA,UAAU,EAAE,YA5C0C;AA6CtD,EAAA,IAAI,EAAE,MA7CgD;AA8CtD,EAAA,IAAI,EAAE,MA9CgD;AA+CtD,EAAA,MAAM,EAAE,QA/C8C;AAgDtD,EAAA,YAAY,EAAE,cAhDwC;AAiDtD,EAAA,WAAW,EAAE,aAjDyC;AAkDtD,EAAA,KAAK,EAAE,OAlD+C;AAmDtD,EAAA,UAAU,EAAE,YAnD0C;AAoDtD,EAAA,KAAK,EAAE,OApD+C;AAqDtD,EAAA,MAAM,EAAE,QArD8C;AAsDtD,EAAA,QAAQ,EAAE,UAtD4C;AAuDtD,EAAA,GAAG,EAAE,KAvDiD;AAwDtD,EAAA,QAAQ,EAAE,UAxD4C;AAyDtD,EAAA,SAAS,EAAE,WAzD2C;AA0DtD,EAAA,SAAS,EAAE,WA1D2C;AA2DtD,EAAA,MAAM,EAAE,QA3D8C;AA4DtD,EAAA,SAAS,EAAE,WA5D2C;AA6DtD,EAAA,OAAO,EAAE,SA7D6C;AA8DtD,EAAA,WAAW,EAAE,aA9DyC;AA+DtD,EAAA,MAAM,EAAE,QA/D8C;AAgEtD,EAAA,SAAS,EAAE,WAhE2C;AAiEtD,EAAA,MAAM,EAAE,QAjE8C;AAkEtD,EAAA,UAAU,EAAE,YAlE0C;AAmEtD,EAAA,MAAM,EAAE,QAnE8C;AAoEtD,EAAA,SAAS,EAAE,WApE2C;AAqEtD,EAAA,MAAM,EAAE,QArE8C;AAsEtD,EAAA,GAAG,EAAE,KAtEiD;AAuEtD,EAAA,KAAK,EAAE,OAvE+C;AAwEtD,EAAA,OAAO,EAAE,SAxE6C;AAyEtD,EAAA,QAAQ,EAAE,UAzE4C;AA0EtD,EAAA,IAAI,EAAE,MA1EgD;AA2EtD,EAAA,OAAO,EAAE,SA3E6C;AA4EtD,EAAA,KAAK,EAAE,OA5E+C;AA6EtD,EAAA,OAAO,EAAE,SA7E6C;AA8EtD,EAAA,OAAO,EAAE,SA9E6C;AA+EtD,EAAA,IAAI,EAAE,MA/EgD;AAgFtD,EAAA,QAAQ,EAAE,UAhF4C;AAiFtD,EAAA,QAAQ,EAAE,UAjF4C;AAkFtD,EAAA,MAAM,EAAE,QAlF8C;AAmFtD,EAAA,MAAM,EAAE;AAnF8C,CAAxD;AAsFM,SAAU,SAAV,CAAoB,OAApB,EAAwC;AAC5C,SAAO,OAAO,CAAC,YAAR,CAAqB,MAArB,KAAgC,WAAW,CAAC,OAAO,CAAC,OAAT,CAA3C,IAAgE,SAAvE;AACD;AAEK,SAAU,UAAV,CAAqB,OAArB,EAAyC;AAC7C,SAAO,OAAO,CAAC,SAAf;AACD;;AC1FK,SAAU,WAAV,GAAqB;AACzB,QAAM;AAAE,IAAA;AAAF,MAAY,MAAM,CAAC,QAAzB;AACA,QAAM;AAAE,IAAA,QAAF;AAAY,IAAA;AAAZ,MAAyB,MAAM,CAAC,QAAtC;AACA,SAAO;AAAE,IAAA,KAAF;AAAS,IAAA,QAAT;AAAmB,IAAA;AAAnB,GAAP;AACD;AAEK,SAAU,mBAAV,CAA8B,QAA9B,EAA8C;AAAA;;AAClD,QAAM,UAAU,sBAAG,QAAQ,CAAC,KAAT,CAAe,IAAf,CAAH,oDAAG,gBAAsB,MAAzC;AACA,MAAI,CAAC,UAAL,EAAiB,OAAO;AAAE,IAAA,OAAO,EAAE,EAAX;AAAe,IAAA,QAAQ,EAAE;AAAzB,GAAP;AACjB,MAAI,UAAU,KAAK,CAAf,IAAoB,UAAU,KAAK,CAAvC,EAA0C,OAAO;AAAE,IAAA,OAAO,EAAE,EAAX;AAAe,IAAA,QAAQ,EAAE;AAAzB,GAAP,CAHQ;;AAKlD,QAAM,aAAa,GAAG,QAAQ,CAAC,KAAT,CAAe,GAAf,CAAtB;AACA,QAAM,OAAO,GAAG,aAAa,CAAC,CAAD,CAA7B;AACA,QAAM,QAAQ,GAAG,aAAa,CAAC,MAAd,CAAqB,CAArB,EAAwB,aAAa,CAAC,MAAtC,EAA8C,IAA9C,CAAmD,GAAnD,CAAjB;AACA,SAAO;AAAE,IAAA,OAAF;AAAW,IAAA;AAAX,GAAP;AACD;AAEK,SAAU,wBAAV,GAAkC;AACtC,QAAM,aAAa,GAAG,MAAM,CAAC,QAAP,CAAgB,QAAhB,CAAyB,KAAzB,CAA+B,GAA/B,CAAtB;AACA,QAAM,aAAa,GAAG,aAAa,CAAC,MAAd,GAAuB,CAAvB,GAA2B,aAAa,CAAC,CAAD,CAAxC,GAA8C,EAApE;AACA,QAAM;AAAE,IAAA,OAAF;AAAW,IAAA;AAAX,MAAwB,mBAAmB,CAAC,aAAD,CAAjD;AAEA,SAAO;AACL,IAAA,MAAM,EAAE,cAAc,CAAC,OAAf,CAAuB,QAAvB,KAAoC,OADvC;AAEL,IAAA,IAAI,EAAE,SAAS,CAAC,QAAV,IAAsB,EAFvB;AAGL,IAAA,EAAE,EAAE,SAAS,CAAC,SAAV,IAAuB,EAHtB;AAIL,IAAA,SAAS,EAAE,IAAI,CAAC,GAAL,EAJN;AAKL,IAAA,QALK;AAML,IAAA;AANK,GAAP;AAQD;;ACtBK,MAAO,aAAP,CAAoB;AAA1B,EAAA,WAAA,GAAA;AACU,SAAA,MAAA,GAAkB,EAAlB;AAEA,SAAA,YAAA,GAAsB,WAAW,EAAjC;AA2GT;;AAzGC,EAAA,QAAQ,CAAC,KAAD,EAAa;AACnB,IAAA,KAAK,CAAC,UAAN;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,KAAjB;AACD;;AAED,EAAA,aAAa,CAAC,OAAD,EAAiB;AAC5B;AACA;AACA,IAAA,UAAU,CAAC,MAAM,KAAK,OAAL,CAAa,WAAW,EAAxB,CAAP,EAAoC,GAApC,CAAV;AACA,IAAA,OAAO,CAAC,MAAR,CAAe,MAAK;AAClB,YAAM;AAAE,QAAA;AAAF,UAAa,OAAnB,CADkB;;AAGlB,UAAI,MAAM,KAAK,MAAf,EAAuB;AACrB,QAAA,UAAU,CAAC,MAAM,KAAK,OAAL,CAAa,WAAW,EAAxB,CAAP,EAAoC,GAApC,CAAV;AACD;AACF,KAND;AAOD;;AAED,EAAA,QAAQ,GAAA;AACN,IAAA,MAAM,CAAC,gBAAP,CAAwB,OAAxB,EAAiC,KAAK,IAAG;AACvC,YAAM;AAAE,QAAA;AAAF,UAAa,KAAnB;;AACA,UAAI,MAAM,YAAY,WAAtB,EAAmC;AACjC,aAAK,KAAL,CAAW;AACT,UAAA,SAAS,EAAE,OADF;AAET,UAAA,QAAQ,EAAE,SAFD;AAGT,UAAA,cAAc,EAAE;AACd,YAAA,IAAI,EAAEE,UAAA,CAAe,MAAf,CADQ;AAEd,YAAA,KAAK,EAAE,EAFO;AAGd,YAAA,IAAI,EAAEC,SAAA,CAAc,MAAd;AAHQ;AAHP,SAAX;AASD;AACF,KAbD;AAcD,GAtCuB;;;AAyCxB,EAAA,wBAAwB,CAAC,MAAD,EAA6B;AACnD,QAAI,iBAAiB,GAAW,CAAhC;;AAEA,UAAM,mBAAmB,GAAI,CAAD,IAAa;AACvC,UAAI,QAAQ,CAAC,eAAT,KAA6B,QAAjC,EAA2C;AACzC,cAAM,eAAe,GAAG,CAAC,CAAC,SAA1B;AACA,cAAM,QAAQ,GAAG,IAAI,CAAC,KAAL,CAAW,eAAe,GAAG,iBAA7B,CAAjB;AACA,aAAK,KAAL,CAAW;AACT,UAAA,SAAS,EAAE,UADF;AAET,UAAA,QAAQ,EAAE,SAFD;AAGT,UAAA,cAAc,EAAE;AACd,YAAA,GAAG,EAAE,MAAM,CAAC,QAAP,CAAgB,IADP;AAEd,YAAA,QAFc;AAGd,eAAG;AAHW;AAHP,SAAX;AASD;;AACD,UAAI,QAAQ,CAAC,eAAT,KAA6B,SAAjC,EAA4C;AAC1C,QAAA,iBAAiB,GAAG,CAAC,CAAC,SAAtB;AACD;AACF,KAjBD;;AAkBA,IAAA,QAAQ,CAAC,gBAAT,CAA0B,kBAA1B,EAA8C,mBAA9C;AACD;;AAED,EAAA,2BAA2B,CAAC,OAAD,EAAmB,MAAnB,EAA+C;AACxE,QAAI,iBAAiB,GAAW,IAAI,CAAC,GAAL,EAAhC;AACA,QAAI,GAAG,GAAG,MAAM,CAAC,QAAP,CAAgB,IAA1B;AACA,IAAA,OAAO,CAAC,MAAR,CAAe,MAAK;AAClB,YAAM,eAAe,GAAW,IAAI,CAAC,GAAL,EAAhC;AACA,YAAM,QAAQ,GAAG,IAAI,CAAC,KAAL,CAAW,eAAe,GAAG,iBAA7B,CAAjB;AACA,WAAK,KAAL,CAAW;AACT,QAAA,SAAS,EAAE,UADF;AAET,QAAA,QAAQ,EAAE,SAFD;AAGT,QAAA,cAAc,EAAE;AACd,UAAA,GADc;AAEd,UAAA,QAFc;AAGd,aAAG;AAHW;AAHP,OAAX;AASA,MAAA,iBAAiB,GAAG,eAApB;AACA,MAAA,GAAG,GAAG,MAAM,CAAC,QAAP,CAAgB,IAAtB;AACD,KAdD;AAeD;;AAED,EAAA,KAAK,CAAC,MAAD,EAAe;AAClB,SAAK,MAAL,CAAY,OAAZ,CAAoB,KAAK,IAAI,KAAK,CAAC,MAAN,CAAa;AAAE,MAAA,IAAI,EAAE,OAAR;AAAiB,MAAA;AAAjB,KAAb,CAA7B;AACD;;AAED,EAAA,OAAO,CAAC,OAAD,EAAe;AACpB,UAAM,SAAS,GAAG,KAAK,YAAvB;AACA,UAAM,KAAK,GAAoB;AAC7B,MAAA,IAAI,EAAE,YADuB;AAE7B,MAAA,SAF6B;AAG7B,MAAA,OAH6B;AAI7B,MAAA,qBAAqB,EAAE,wBAAwB;AAJlB,KAA/B;AAMA,SAAK,MAAL,CAAY,OAAZ,CAAoB,KAAK,IAAI,KAAK,CAAC,MAAN,CAAa,KAAb,CAA7B;AACD;;AAED,EAAA,KAAK,CAAC,KAAD,EAAmC;AACtC,UAAM;AAAE,MAAA;AAAF,QAAqB,KAA3B;AACA,UAAM,aAAa,GAAG,CAAA,cAAc,SAAd,IAAA,cAAc,WAAd,YAAA,cAAc,CAAE,cAAhB,CAA+B,aAA/B,KAAgD,EAAhD,GAAqD,wBAAwB,EAAnG;AACA,UAAM,oBAAoB,GAAG,EAC3B,GAAG,aADwB;AAE3B,SAAG;AAFwB,KAA7B;AAIA,IAAA,KAAK,CAAC,cAAN,GAAuB,oBAAvB;AACA,SAAK,MAAL,CAAY,OAAZ,CAAoB,KAAK,IAAI,KAAK,CAAC,MAAN,CAAa;AAAE,MAAA,IAAI,EAAE,UAAR;AAAoB,SAAG;AAAvB,KAAb,CAA7B;AACD;;AA7GuB;;ACV1B,CAAA,UAAY,SAAZ,EAAqB;AACnB,EAAA,SAAA,CAAA,SAAA,CAAA,KAAA,CAAA,GAAA,CAAA,CAAA,GAAA,KAAA;AACA,EAAA,SAAA,CAAA,SAAA,CAAA,MAAA,CAAA,GAAA,GAAA,CAAA,GAAA,MAAA;AACA,EAAA,SAAA,CAAA,SAAA,CAAA,MAAA,CAAA,GAAA,CAAA,CAAA,GAAA,MAAA;AACD,CAJD,EAAYC,iBAAS,KAATA,iBAAS,GAAA,EAAA,CAArB;;ACIA,MAAM,eAAN,CAAqB;AAOnB,EAAA,WAAA,CAAY,QAAZ,EAA+B,SAA/B,EAAmD;AAF3C,SAAA,eAAA,GAAkB,CAAlB;;AAsBR,SAAA,cAAA,GAAiB,CAAC,GAAD,EAAsB,QAAtB,KAA4C;AAAA;;AAC3D,6BAAK,QAAL,kEAAe,OAAf,CAAuB,GAAG,CAAC,OAA3B;AACA,WAAK,UAAL,CAAgB,GAAhB,CAAoB,GAAG,CAAC,OAAxB,EAAiC,QAAjC;AACD,KAHD;;AAKA,SAAA,gBAAA,GAAoB,GAAD,IAAwB;AAAA;;AACzC,8BAAK,QAAL,oEAAe,SAAf,CAAyB,GAAG,CAAC,OAA7B;AACA,UAAI,KAAK,UAAL,CAAgB,GAAhB,CAAoB,GAAG,CAAC,OAAxB,CAAJ,EAAsC,KAAK,UAAL,CAAgB,MAAhB,CAAuB,GAAG,CAAC,OAA3B;AACvC,KAHD;;AAKA,SAAA,oBAAA,GAAuB,MAAK;AAC1B,WAAK,UAAL,CAAgB,OAAhB,CAAwB,CAAC,KAAD,EAAQ,GAAR,KAAe;AAAA;;AACrC,gCAAK,QAAL,oEAAe,OAAf,CAAuB,GAAvB;AACD,OAFD;AAGD,KAJD;;AAMQ,SAAA,gBAAA,GAAoB,OAAD,IAAyC;AAClE,MAAA,OAAO,CAAC,OAAR,CAAgB,KAAK,IAAG;AACtB,cAAM;AAAE,UAAA;AAAF,YAAa,KAAnB;;AACA,YAAI,KAAK,CAAC,cAAN,IAAwB,KAAK,UAAL,CAAgB,GAAhB,CAAoB,MAApB,CAA5B,EAAyD;AAAA;;AACvD,gBAAM,QAAQ,GAAG,KAAK,UAAL,CAAgB,GAAhB,CAAoB,MAApB,CAAjB;AACA,cAAI,CAAC,QAAL,EAAe;AAEf,UAAA,QAAQ;AAER,kCAAK,QAAL,oEAAe,SAAf,CAAyB,MAAzB;AACD;AACF,OAVD;AAWD,KAZO;;AAcA,SAAA,wBAAA,GAA4B,OAAD,IAAyC;AAC1E,MAAA,OAAO,CAAC,OAAR,CAAgB,KAAK,IAAG;AACtB,cAAM;AAAE,UAAA;AAAF,YAAa,KAAnB;;AACA,YAAI,KAAK,CAAC,cAAN,IAAwB,KAAK,UAAL,CAAgB,GAAhB,CAAoB,MAApB,CAA5B,EAAyD;AAAA;;AACvD,gBAAM,QAAQ,GAAG,KAAK,UAAL,CAAgB,GAAhB,CAAoB,MAApB,CAAjB;AACA,cAAI,CAAC,QAAL,EAAe;AAEf,UAAA,YAAY,CAAC,KAAK,eAAN,CAAZ;AACA,eAAK,eAAL,GAAuB,MAAM,CAAC,UAAP,CAAkB,MAAK;AAC5C,YAAA,QAAQ;AACT,WAFsB,EAEpB,IAFoB,CAAvB;AAIA,kCAAK,QAAL,oEAAe,SAAf,CAAyB,MAAzB;AACD;AACF,OAbD;AAcD,KAfO;;AAjDN,SAAK,UAAL,GAAkB,IAAI,GAAJ,EAAlB;;AACA,QAAI;AACF,WAAK,QAAL,GAAgB,IAAI,MAAM,CAAC,oBAAX,CACd,OAAO,IAAG;AACR,YAAI,QAAJ,EAAc;AACZ,eAAK,wBAAL,CAA8B,OAA9B;AACD,SAFD,MAEO;AACL,eAAK,gBAAL,CAAsB,OAAtB;AACD;AACF,OAPa,EAQd;AACE,QAAA,SAAS,EAAE,CAAC,SAAD;AADb,OARc,CAAhB;AAYD,KAbD,CAaE,OAAO,KAAP,EAAc;AACd,MAAA,OAAO,CAAC,GAAR,CAAY,mDAAmD,KAAK,EAApE;AACD;AACF;;AAzBkB;;MA2ER,uBAAuB,GAAG,IAAI,eAAJ,CAAoB,KAApB,EAA2BA,iBAAS,CAAC,IAArC;MAC1B,mBAAmB,GAAG,IAAI,eAAJ,CAAoB,KAApB,EAA2BA,iBAAS,CAAC,IAArC;MACtB,kBAAkB,GAAG,IAAI,eAAJ,CAAoB,KAApB,EAA2BA,iBAAS,CAAC,GAArC;MACrB,mBAAmB,GAAG,IAAI,eAAJ,CAAoB,IAApB,EAA0BA,iBAAS,CAAC,IAApC;;MC9EtB,0BAA0B,GAAG,CAAC,GAAD,EAAsB,QAAtB,KAA4C;AACpF,EAAAC,eAAS,CAAC,MAAK;AACb,QAAI,GAAG,CAAC,OAAJ,KAAgB,IAApB,EAA0B;AAC1B,IAAA,uBAAuB,CAAC,cAAxB,CAAuC,GAAvC,EAA4C,QAA5C;AACA,WAAO,MAAK;AACV,MAAA,uBAAuB,CAAC,gBAAxB,CAAyC,GAAzC;AACD,KAFD;AAGD,GANQ,CAAT;AAOD;MAEY,sBAAsB,GAAG,CAAC,GAAD,EAAsB,QAAtB,KAA4C;AAChF,EAAAA,eAAS,CAAC,MAAK;AACb,QAAI,GAAG,CAAC,OAAJ,KAAgB,IAApB,EAA0B;AAC1B,IAAA,mBAAmB,CAAC,cAApB,CAAmC,GAAnC,EAAwC,QAAxC;AACA,WAAO,MAAK;AACV,MAAA,mBAAmB,CAAC,gBAApB,CAAqC,GAArC;AACD,KAFD;AAGD,GANQ,CAAT;AAOD;MAEY,qBAAqB,GAAG,CAAC,GAAD,EAAsB,QAAtB,KAA4C;AAC/E,EAAAA,eAAS,CAAC,MAAK;AACb,QAAI,GAAG,CAAC,OAAJ,KAAgB,IAApB,EAA0B;AAC1B,IAAA,kBAAkB,CAAC,cAAnB,CAAkC,GAAlC,EAAuC,QAAvC;AACA,WAAO,MAAK;AACV,MAAA,kBAAkB,CAAC,gBAAnB,CAAoC,GAApC;AACD,KAFD;AAGD,GANQ,CAAT;AAOD;MAEY,sBAAsB,GAAG,CAAC,GAAD,EAAsB,QAAtB,KAA4C;AAChF,EAAAA,eAAS,CAAC,MAAK;AACb,QAAI,GAAG,CAAC,OAAJ,KAAgB,IAApB,EAA0B;AAC1B,IAAA,mBAAmB,CAAC,cAApB,CAAmC,GAAnC,EAAwC,QAAxC;AACA,WAAO,MAAK;AACV,MAAA,mBAAmB,CAAC,gBAApB,CAAqC,GAArC;AACD,KAFD;AAGD,GANQ,CAAT;AAOD;AAEK,SAAU,OAAV,GAAiB;AACrB,EAAA,mBAAmB,CAAC,cAApB,CAAmC,EAAnC,EAAyD,MAAK,EAA9D;AACD;;AC9CM,MAAM,gBAAgB,GAAG,OAAzB;AACA,MAAM,gBAAgB,GAAG,OAAzB;AACA,MAAM,gBAAgB,GAAG,OAAzB;AACA,MAAM,iBAAiB,GAAG,QAA1B;AACA,MAAM,uBAAuB,GAAG,cAAhC;AAEA,MAAM,gBAAgB,GAAG,SAAzB;AAEA,MAAM,mBAAmB,GAAG,aAA5B;AACA,MAAM,gBAAgB,GAAG,UAAzB;AACA,MAAM,oBAAoB,GAAG,cAA7B;AACA,MAAM,iBAAiB,GAAG,WAA1B;AACA,MAAM,YAAY,GAAG,OAArB;;ACMD,SAAU,uBAAV,CAAkC,UAAlC,EAAsD,IAAtD,EAAkE;AACtE,SAAO;AACL,IAAA,SAAS,EAAE,gBADN;AAEL,IAAA,QAAQ,EAAE,gBAFL;AAGL,IAAA,cAAc,EAAE;AACd,MAAA,MAAM,EAAE,mBADM;AAEd,MAAA,IAAI,EAAE,UAFQ;AAGd,MAAA,IAAI,EAAE;AAHQ;AAHX,GAAP;AASD;AAEK,SAAU,qBAAV,CACJ,WADI,EAEJ,UAFI,EAGJ,SAHI,EAIJ,SAJI,EAIa;AAEjB,SAAO;AACL,IAAA,SAAS,EAAE,gBADN;AAEL,IAAA,QAAQ,EAAE,gBAFL;AAGL,IAAA,cAAc,EAAE;AACd,MAAA,WADc;AAEd,MAAA,UAFc;AAGd,MAAA,SAHc;AAId,MAAA;AAJc;AAHX,GAAP;AAUD;AAEK,SAAU,qBAAV,GAA+B;AACnC,SAAO;AACL,IAAA,SAAS,EAAE,gBADN;AAEL,IAAA,QAAQ,EAAE;AAFL,GAAP;AAID;AAEK,SAAU,oBAAV,CAA+B,IAA/B,EAA6C,OAA7C,EAA4D;AAChE,SAAO;AACL,IAAA,SAAS,EAAE,gBADN;AAEL,IAAA,QAAQ,EAAE,gBAFL;AAGL,IAAA,cAAc,EAAE;AACd,MAAA,MAAM,EAAE,gBADM;AAEd,MAAA,IAAI,EAAE,IAFQ;AAGd,MAAA,IAAI,EAAE;AAHQ;AAHX,GAAP;AASD;AAEK,SAAU,wBAAV,CAAmC,MAAnC,EAAmD,UAAnD,EAAwE,WAAxE,EAA2F;AAC/F,SAAO;AACL,IAAA,SAAS,EAAE,gBADN;AAEL,IAAA,QAAQ,EAAE,gBAFL;AAGL,IAAA,cAAc,EAAE;AACd,MAAA,MAAM,EAAE,oBADM;AAEd,MAAA,IAAI,EAAE,WAFQ;AAGd,MAAA,UAAU,EAAE,MAHE;AAId,MAAA,UAAU,EAAE,UAJE;AAKd,MAAA,aAAa,EAAE,EALD;AAMd,MAAA,WAAW,EAAE;AANC;AAHX,GAAP;AAYD;AAEK,SAAU,kBAAV,CAA6B,OAA7B,EAA8C,KAA9C,EAA2D;AAC/D,SAAO;AACL,IAAA,SAAS,EAAE,iBADN;AAEL,IAAA,QAAQ,EAAE,gBAFL;AAGL,IAAA,cAAc,EAAE;AACd,MAAA,YAAY,EAAE,OADA;AAEd,MAAA,WAAW,EAAE;AAFC;AAHX,GAAP;AAQD;AAEK,SAAU,gBAAV,CAA2B,SAA3B,EAA4C;AAChD,SAAO;AACL,IAAA,SAAS,EAAE,gBADN;AAEL,IAAA,QAAQ,EAAE,gBAFL;AAGL,IAAA,cAAc,EAAE;AACd,MAAA,MAAM,EAAE,mBADM;AAEd,MAAA,IAAI,EAAE,SAFQ;AAGd,MAAA,IAAI,EAAE;AAHQ;AAHX,GAAP;AASD;AAEK,SAAU,kCAAV,CAA6C,IAA7C,EAAyD;AAC7D,SAAO;AACL,IAAA,SAAS,EAAE,uBADN;AAEL,IAAA,QAAQ,EAAE,gBAFL;AAGL,IAAA,cAAc,EAAE;AACd,MAAA,MAAM,EAAE,YADM;AAEd,MAAA,OAAO,EAAE,iBAFK;AAGd,MAAA;AAHc;AAHX,GAAP;AASD;AAEK,SAAU,qBAAV,CAAgC,IAAhC,EAA8C,QAA9C,EAA8D;AAClE,SAAO;AACL,IAAA,SAAS,EAAE,gBADN;AAEL,IAAA,QAAQ,EAAE,gBAFL;AAGL,IAAA,cAAc,EAAE;AACd,MAAA,MAAM,EAAE,iBADM;AAEd,MAAA,GAAG,EAAE,IAFS;AAGd,MAAA,IAAI,EAAE;AAHQ;AAHX,GAAP;AASD;AAEK,SAAU,uBAAV,CAAkC,OAAlC,EAAiD;AACrD,SAAO;AACL,IAAA,SAAS,EAAE,uBADN;AAEL,IAAA,QAAQ,EAAE,gBAFL;AAGL,IAAA,cAAc,EAAE;AACd,MAAA,MAAM,EAAE,YADM;AAEd,MAAA;AAFc;AAHX,GAAP;AAQD;;;;;;;;;;;;;;;;;;;;;;;;;;"}